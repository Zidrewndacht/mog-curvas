<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Curvas</title>
  <link rel="stylesheet" href="style.css">
  <!-- <script src="scripts.js" defer></script> -->
  <script src="math.js" defer></script>
  <script src="draw.js" defer></script>
  <script src="events.js" defer></script>
  <script src="main.js" defer></script>
</head>

<body>
  <button id="minimize-toggle" class="minimize-button">‚õ≠</button>
  <div id="ui-controls-wrapper">
    <div id="ui-controls">
      <div class="ui-info">
        <h1><span style="color:#004015c0">NURBS grau 3</span> + <span style="color:darkred">B√©zier Grau 7</span></h1>
        <p>Mova os pontos de controle existentes arrastando-os com o bot√£o esquerdo do mouse.</p>
        <p>Clique <!--(ou toque)--> com o bot√£o esquerdo no espa√ßo vazio para adicionar novo ponto √† <span style="font-weight: bold;color:#004015c0">curva 1</span>. 
          <br>A <span style="font-weight: bold;color:darkred">curva 2</span> possui n√∫mero fixo de pontos de controle (8).<br>
        <p>Clique com o bot√£o direito <!--(ou segure com o dedo)--> sobre um ponto para configurar (posi√ß√£o e peso, se aplic√°vel) ou
          remover o ponto. Pontos da curva de b√©zier n√£o s√£o remov√≠veis.<br>
        <p>Clique na engrenagem no canto superior esquerdo para minimizar ou re-exibir esta p√°gina de configura√ß√£o.<br>
        <p>Ajuste as configura√ß√µes globais a seguir conforme necess√°rio:</p>
      </div>
      <div class="controls-wrapper">
        <div class="control-group" id="NURBS-settings">
          <!-- <h1>Configura√ß√µes das curvas</h1> -->
          <div id="NURBSKnotWrapper">
            <label for="NURBSknotVector">Vetor de n√≥s da NURBS:</label>
            <input type="text" id="NURBSknotVector">
            <button id="resetKnots">Restaurar</button>
            <button id="applyKnots" style="display:none;">Aplicar</button>
          </div>
          <div class="checkbox-item">
              <input type="checkbox" id="forceC1" title="Ativar esta op√ß√£o manipula automaticamente os pontos 1 (NURBS) e 6 (b√©zier) ao interagir com pontos 0 ou 1. Tamb√©m desabilita o ajuste de pesos e/ou a exclus√£o do ponto 1 da NURBS." >
              <label for="forceC1" class="checkbox-lbl" >For√ßar C1</label>
          </div>
          <!-- <div class="checkbox-item">
              <input type="checkbox" id="forceG2" >
              <label for="forceG2" class="checkbox-lbl">For√ßar G2</label>
          </div> -->
          <div class="checkbox-item">
              <input type="checkbox" id="forceC2" title="Ativar esta op√ß√£o manipula automaticamente os pontos 1 e 2 (NURBS) e 5 e 6 (b√©zier) ao interagir com pontos 0 ou 1. Tamb√©m desabilita o ajuste do vetor de n√≥s, ajuste de pesos e/ou a exclus√£o dos pontos 1 a 4 da NURBS."> 
              <label for="forceC2" class="checkbox-lbl">For√ßar C2</label>
          </div>
          <div id="sampleCount-container">
              <label for="sampleCount" class="setting-lbl">N√∫mero de amostras por segmento:</label>
              <input type="number" id="sampleCount" min="2" max="100" value="50" step="2">
          </div>
        </div>

        <div class="control-group" id="view-settings">
            <!-- <h1>Configura√ß√µes da visualiza√ß√£o</h1> -->
            <div class="checkbox-item">
                <input type="checkbox" id="showControlPolygon" checked>
                <label for="showControlPolygon" class="checkbox-lbl">Exibir pol√≠gono <br>de controle</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="showControlPoints" checked>
                <label for="showControlPoints" class="checkbox-lbl">Exibir pontos <br>de controle</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="showPointIndex" checked >
                <label for="showPointIndex" class="checkbox-lbl">Exibir <br>√≠ndices</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="showWeights">
                <label for="showWeights" class="checkbox-lbl" >Exibir <br>pesos</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="showKnots">
                <label for="showKnots" class="checkbox-lbl">Exibir <br>n√≥s</label>
            </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Usando t√©cnica similar √† de IoT-entrada-escola para animar popup. -->
  <div id="pointContextMenu" class="context-menu">
    <div class="menu-item" id="contextTitle">Editando: <strong><span id="contextCurveTitle"></span></strong></div>
    <div id="setXYZ">
      <div class="menu-item">x:
        <input type="number" id="setX" class="menu-number-input" step="1" >
      </div>
      <div class="menu-item">y:
        <input type="number" id="setY" class="menu-number-input" step="1" >
      </div>
      <div class="menu-item">z:
        <input type="number" id="setZ" class="menu-number-input" step="1" disabled >
      </div>
    </div>
    <div class="menu-item" id="setWeight"><span>Peso: </span>
      <input type="number" id="weightInput" class="menu-number-input" step="0.1" value="1.0" >
    </div>
    <div class="menu-item" id="deletePoint"><span>Remover ponto üóëÔ∏è </span></div>
  </div>

  <div id="debugPopup" class="context-menu">
    <div class="menu-item">
      1¬™ Derivada na B√©zier: <span>
        <strong><span id="bezierMagnitude">0</span></strong> ‚à† 
        <strong><span id="bezierAngle">0</span>¬∞</strong>
      </span>
    </div>
    <div class="menu-item">
      1¬™ Derivada na NURBS: <span>
        <strong><span id="NURBSmagnitude">0</span></strong> ‚à† 
        <strong><span id="NURBSangle">0</span>¬∞</strong>
      </span>
    </div>
    <br>
    
    <div class="menu-item">
      2¬™ Derivada B√©zier: <span>
        <strong><span id="bezierMagnitude2">0</span></strong> ‚à† 
        <strong><span id="bezierAngle2">0</span>¬∞</strong>
      </span>
    </div>
    <div class="menu-item">
      2¬™ Derivada NURBS: <span>
        <strong><span id="NURBSmagnitude2">0</span></strong> ‚à† 
        <strong><span id="NURBSangle2">0</span>¬∞</strong>
      </span>
    </div>
    <br>

    <div class="menu-item">
      Continuidade: 
      <strong><span id="continuityLevel">G1</span></strong>
    </div>
    <br>
    <div class="menu-item">
        <label for="showDebugPopup" class="checkbox-lbl">Manter popup e vetores sempre vis√≠veis: </label>
        <input type="checkbox" id="showDebugPopup">
    </div>

  </div>
  
  <!-- <div id="pointInfoPopup" class="context-menu">
    <div class="menu-item">Tipo: <span id="curveType"></span></div>
    <div class="menu-item">Ponto: <span id="pointIndex">0</span></div>
    <div class="menu-item">Posi√ß√£o x, y, z:
      <span class="coords">
        <span id="pointX">0</span>,
        <span id="pointY">0</span>,
        <span id="pointZ">0</span>
      </span>
    </div>
    <div class="menu-item">Peso: <span id="pointWeight">1.0</span></div> -->
    <!-- <div class="menu-item">Par√¢metro t: <span id="tValue">0</span></div> -->
  <!-- </div> -->

    
  <div id="pointInfoPopup" class="context-menu">
    <div class="menu-item">Tipo de curva: <span id="curveType"></span></div>
    <div class="menu-item">√çndice do ponto: <span id="pointIndex">0</span></div>
      <!-- <span class="coords"> -->
    <div class="menu-item">Posi√ß√£o x:     <span id="pointX">0</span>
  </div>
    <div class="menu-item">Posi√ß√£o y:     <span id="pointY">0</span>
  </div>
    <div class="menu-item" style="color:#0005">Posi√ß√£o z:     <span id="pointZ">0</span>
  </div>
      <!-- </span> -->
    <div class="menu-item">Peso: <span id="pointWeight">1.0</span></div>
  </div>
  
  <div id="about-wrapper">
    <div id="about">
        <p>Desenvolvido por Luis Alfredo, como estudante de mestrado do PPGEEL da UDESC Joinville, como trabalho final para a disciplina de Modelagem Geom√©trica (Prof. Roberto S. U. Rosso Jr.)</p>
        <p>Este trabalho est√° licenciado com licen√ßa <a target=_blank href="#">MIT</a>.</p>
        <p>As opera√ß√µes envolvendo HTML Canvas, em sua maioria, j√° eram de conhecimento do autor. Para refer√™ncia adicional, quando necess√°rio, foi usada a <a target=_blank href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API">documenta√ß√£o da MDN.</a>

        <p>Para confer√™ncia/compara√ß√£o de resultados (em especial, verifica√ß√£o do comportamento da NURBS, identificando se equipara-se a uma implementa√ß√£o de terceiros), <a target=_blank href="https://nurbscalculator.in/">NURBS Calculator</a> foi utilizada.

        <p>A implementa√ß√£o da curva de b√©zier foi adaptada a partir do pseudoc√≥digo do algoritmo de De Casteljau do livro online <a target=_blank href="https://pomax.github.io/bezierinfo/">"A Primer on B√©zier Curves".</a>

        <p>Mortenson (2006) e The NURBS Book (e o <a target=_blank href="https://github.com/BIMCoderLiang/LNLib">c√≥digo-fonte correspondente</a>) foram consultados, entretanto os outros recursos aqui indicados, em geral, foram mais did√°ticos e mais largamente utilizados.

        <p>Algumas etapas foram auxiliadas por modelos de linguagem (especificamente <a target=_blank href="https://chat.deepseek.com/">DeepSeek</a> nas vers√µes V3 0324 e R1 0528):
        <ul>
          <li>Identifica√ß√£o e corre√ß√£o de bugs nas t√©cnicas de intera√ß√£o com o usu√°rio;
          <li>Adapta√ß√£o do algoritmo da NURBS (Cox-De Boor);
          <li>Adapta√ß√£o das f√≥rmulas para derivadas da NURBS;
        </ul>
        <p>A interface de usu√°rio (caixas de sele√ß√£o, bot√µes, dicas de ferramenta, menus de contexto, anima√ß√µes, etc.) usa apenas HTML e CSS 'puros', tamb√©m sem bibliotecas adicionais. A aplica√ß√£o √© intencionalmente desenvolvida de forma a n√£o ter nenhuma depend√™ncia externa al√©m dos arquivos HTML, CSS, JS inclusos.
        <p>Clique em qualquer lugar da p√°gina para fechar esta janela.</p>

    </div>
  </div>


  <canvas id="curves-canvas"></canvas>
  <footer>
    <p><!--&copy; 2025 --> Luis Alfredo - Modelagem Geom√©trica - UDESC PPGEEL - 2025
      <a id="license-link" href="#">Sobre / Licen√ßa</a>
    </p>
  </footer>
</body>

</html>